# Парсер сайта online.metro-cc.ru

Этот репозиторий содержит парсер для сайта online.metro-cc.ru, который позволяет спарсить все товары в категории. По умолчанию парсер собирает данные только товаров что есть в наличии.

## Собранные данные
Для каждого товара, парсер собирает следующие данные:

- id товара из сайта
- наименование товара
- ссылка на товар
- регулярная цена
- промо цена
- бренд (сбор инфомации бренда,занимает очень много врмеени, поскольку на страници каталога нет инфомации о бренде и приходится заходить на страницу скаждого продукта) 

## Установка
Скачайте репозиторий `git clone https://github.com/Doppelgangers/ParserShop`


1. Установите зависимости, указанные в файле requirements.txt, с помощью следующей команды:
    ```
    cmd
    pip install -r requirements.txt
    ```
2. Запустите скрипт main.py:
    ```
    cmd
    python main.py
    ```

## Использование

1. Введите ссылку на категорию которую вы хотите спарсить.
    ``` 
    Введите ссылку на категорию: https://online.metro-cc.ru/category/ovoshchi-i-frukty/frukty
    ```
    Парсер способен так же обрабатывать ссылкки содержащие поиск товара, такие как https://online.metro-cc.ru/search?q=%D0%BC%D0%BE%D1%82%D0%BE%D1%80%D0%BD%D1%8B%D0%B5%20%D0%BC%D0%B0%D1%81%D0%BB%D0%B0&from=under_search 

2. Укажите ID магазина в котором будут собранны данные, найти его можно заранее выбрав город в браузере и просмотрев coockies вашего браузера в поле MetroSroreId

3. По жалению укажите префикс, он будет отображён в начале названия файла `{prefix}__{adress}__{date}.json`

4. Результаты парсинга будут сохранены по умолчанию в папке data в корне проекта.

## Проблемы и их решения
1) Программа перестала запускаться
    Так же возможно что на сайте произошли изменеия в коде страницы, в следствии чего парсер не будет работать пока не будут внесены правки в скрипт.

2) Во время второго парсинга произошла ошибка.
    Вероятнее всего парсилась слишком большое количество файлов в следствии чего сервер разорвал соеденение с парсером. Сделайте перерыв в минуту и запустити скрипт повторно.
 
    
## TODO:
Сделать защиту от разрва соеденения, класс для сбора задач что были завершены не успешно, отправить вновь на парсинг после небольшой паузы.
